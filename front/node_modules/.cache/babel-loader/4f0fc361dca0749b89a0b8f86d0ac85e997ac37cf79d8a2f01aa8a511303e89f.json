{"ast":null,"code":"import { Node, mergeAttributes, nodeInputRule } from '@tiptap/core';\n\n/**\n * Matches an image to a ![image](src \"title\") on input.\n */\nconst inputRegex = /(?:^|\\s)(!\\[(.+|:?)]\\((\\S+)(?:(?:\\s+)[\"'](\\S+)[\"'])?\\))$/;\n/**\n * This extension allows you to insert images.\n * @see https://www.tiptap.dev/api/nodes/image\n */\nconst Image = Node.create({\n  name: 'image',\n  addOptions() {\n    return {\n      inline: false,\n      allowBase64: false,\n      HTMLAttributes: {}\n    };\n  },\n  inline() {\n    return this.options.inline;\n  },\n  group() {\n    return this.options.inline ? 'inline' : 'block';\n  },\n  draggable: true,\n  addAttributes() {\n    return {\n      src: {\n        default: null\n      },\n      alt: {\n        default: null\n      },\n      title: {\n        default: null\n      }\n    };\n  },\n  parseHTML() {\n    return [{\n      tag: this.options.allowBase64 ? 'img[src]' : 'img[src]:not([src^=\"data:\"])'\n    }];\n  },\n  renderHTML({\n    HTMLAttributes\n  }) {\n    return ['img', mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)];\n  },\n  addCommands() {\n    return {\n      setImage: options => ({\n        commands\n      }) => {\n        return commands.insertContent({\n          type: this.name,\n          attrs: options\n        });\n      }\n    };\n  },\n  addInputRules() {\n    return [nodeInputRule({\n      find: inputRegex,\n      type: this.type,\n      getAttributes: match => {\n        const [,, alt, src, title] = match;\n        return {\n          src,\n          alt,\n          title\n        };\n      }\n    })];\n  }\n});\nexport { Image, Image as default, inputRegex };","map":{"version":3,"names":["inputRegex","Image","Node","create","name","addOptions","inline","allowBase64","HTMLAttributes","options","group","draggable","addAttributes","src","default","alt","title","parseHTML","tag","renderHTML","mergeAttributes","addCommands","setImage","commands","insertContent","type","attrs","addInputRules","nodeInputRule","find","getAttributes","match"],"sources":["../src/image.ts"],"sourcesContent":["import {\n  mergeAttributes,\n  Node,\n  nodeInputRule,\n} from '@tiptap/core'\n\nexport interface ImageOptions {\n  /**\n   * Controls if the image node should be inline or not.\n   * @default false\n   * @example true\n   */\n  inline: boolean,\n\n  /**\n   * Controls if base64 images are allowed. Enable this if you want to allow\n   * base64 image urls in the `src` attribute.\n   * @default false\n   * @example true\n   */\n  allowBase64: boolean,\n\n  /**\n   * HTML attributes to add to the image element.\n   * @default {}\n   * @example { class: 'foo' }\n   */\n  HTMLAttributes: Record<string, any>,\n}\n\ndeclare module '@tiptap/core' {\n  interface Commands<ReturnType> {\n    image: {\n      /**\n       * Add an image\n       * @param options The image attributes\n       * @example\n       * editor\n       *   .commands\n       *   .setImage({ src: 'https://tiptap.dev/logo.png', alt: 'tiptap', title: 'tiptap logo' })\n       */\n      setImage: (options: { src: string, alt?: string, title?: string }) => ReturnType,\n    }\n  }\n}\n\n/**\n * Matches an image to a ![image](src \"title\") on input.\n */\nexport const inputRegex = /(?:^|\\s)(!\\[(.+|:?)]\\((\\S+)(?:(?:\\s+)[\"'](\\S+)[\"'])?\\))$/\n\n/**\n * This extension allows you to insert images.\n * @see https://www.tiptap.dev/api/nodes/image\n */\nexport const Image = Node.create<ImageOptions>({\n  name: 'image',\n\n  addOptions() {\n    return {\n      inline: false,\n      allowBase64: false,\n      HTMLAttributes: {},\n    }\n  },\n\n  inline() {\n    return this.options.inline\n  },\n\n  group() {\n    return this.options.inline ? 'inline' : 'block'\n  },\n\n  draggable: true,\n\n  addAttributes() {\n    return {\n      src: {\n        default: null,\n      },\n      alt: {\n        default: null,\n      },\n      title: {\n        default: null,\n      },\n    }\n  },\n\n  parseHTML() {\n    return [\n      {\n        tag: this.options.allowBase64\n          ? 'img[src]'\n          : 'img[src]:not([src^=\"data:\"])',\n      },\n    ]\n  },\n\n  renderHTML({ HTMLAttributes }) {\n    return ['img', mergeAttributes(this.options.HTMLAttributes, HTMLAttributes)]\n  },\n\n  addCommands() {\n    return {\n      setImage: options => ({ commands }) => {\n        return commands.insertContent({\n          type: this.name,\n          attrs: options,\n        })\n      },\n    }\n  },\n\n  addInputRules() {\n    return [\n      nodeInputRule({\n        find: inputRegex,\n        type: this.type,\n        getAttributes: match => {\n          const [,, alt, src, title] = match\n\n          return { src, alt, title }\n        },\n      }),\n    ]\n  },\n})\n"],"mappings":";;AA8CA;;AAEG;AACI,MAAMA,UAAU,GAAG;AAE1B;;;AAGG;AACU,MAAAC,KAAK,GAAGC,IAAI,CAACC,MAAM,CAAe;EAC7CC,IAAI,EAAE,OAAO;EAEbC,UAAUA,CAAA;IACR,OAAO;MACLC,MAAM,EAAE,KAAK;MACbC,WAAW,EAAE,KAAK;MAClBC,cAAc,EAAE;KACjB;GACF;EAEDF,MAAMA,CAAA;IACJ,OAAO,IAAI,CAACG,OAAO,CAACH,MAAM;GAC3B;EAEDI,KAAKA,CAAA;IACH,OAAO,IAAI,CAACD,OAAO,CAACH,MAAM,GAAG,QAAQ,GAAG,OAAO;GAChD;EAEDK,SAAS,EAAE,IAAI;EAEfC,aAAaA,CAAA;IACX,OAAO;MACLC,GAAG,EAAE;QACHC,OAAO,EAAE;MACV;MACDC,GAAG,EAAE;QACHD,OAAO,EAAE;MACV;MACDE,KAAK,EAAE;QACLF,OAAO,EAAE;MACV;KACF;GACF;EAEDG,SAASA,CAAA;IACP,OAAO,CACL;MACEC,GAAG,EAAE,IAAI,CAACT,OAAO,CAACF,WAAW,GACzB,UAAU,GACV;IACL,EACF;GACF;EAEDY,UAAUA,CAAC;IAAEX;EAAc,CAAE;IAC3B,OAAO,CAAC,KAAK,EAAEY,eAAe,CAAC,IAAI,CAACX,OAAO,CAACD,cAAc,EAAEA,cAAc,CAAC,CAAC;GAC7E;EAEDa,WAAWA,CAAA;IACT,OAAO;MACLC,QAAQ,EAAEb,OAAO,IAAI,CAAC;QAAEc;MAAQ,CAAE,KAAI;QACpC,OAAOA,QAAQ,CAACC,aAAa,CAAC;UAC5BC,IAAI,EAAE,IAAI,CAACrB,IAAI;UACfsB,KAAK,EAAEjB;QACR,EAAC;;KAEL;GACF;EAEDkB,aAAaA,CAAA;IACX,OAAO,CACLC,aAAa,CAAC;MACZC,IAAI,EAAE7B,UAAU;MAChByB,IAAI,EAAE,IAAI,CAACA,IAAI;MACfK,aAAa,EAAEC,KAAK,IAAG;QACrB,MAAM,IAAIhB,GAAG,EAAEF,GAAG,EAAEG,KAAK,CAAC,GAAGe,KAAK;QAElC,OAAO;UAAElB,GAAG;UAAEE,GAAG;UAAEC;QAAK,CAAE;;KAE7B,CAAC,CACH;;AAEJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}